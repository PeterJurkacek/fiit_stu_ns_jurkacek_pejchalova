I1130 12:01:02.823086 139791806076736 logger.py:38] LOGGING START. Data are saving to logs_dir: /labs/logs/experiment_7, models_dir: /labs/models/experiment_7
I1130 12:01:02.823202 139791806076736 logger.py:39] log_file_name:file:///labs/logs/experiment_7/runtime.log.7d62077c8fd2.root.log.INFO.20191130-120102.288
I1130 12:01:02.823258 139791806076736 utils.py:103] Greyscale: False
I1130 12:01:03.126205 139791806076736 utils.py:49] dirs: ['O', 'R'], from: /labs/data/raw/DATASET/TRAIN
I1130 12:01:03.126445 139791806076736 load_dataset.py:22] DataInfo => dir_path: /labs/data/raw/DATASET/TRAIN, count: 22564, cache_file_path: /labs/data/processed/experiment_7/DATASETTRAIN.tfcache
I1130 12:01:03.146609 139791806076736 utils.py:49] dirs: ['O', 'R'], from: /labs/data/raw/DATASET/TEST
I1130 12:01:03.146804 139791806076736 load_dataset.py:22] DataInfo => dir_path: /labs/data/raw/DATASET/TEST, count: 2513, cache_file_path: /labs/data/processed/experiment_7/DATASETTEST.tfcache
I1130 12:01:03.146866 139791806076736 utils.py:108] Number of channels: 3
I1130 12:01:04.931754 139791806076736 load_dataset.py:105] batch_size:64
BatchInfo => Count of images in one batch:64
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
I1130 12:01:05.892754 139791806076736 load_dataset.py:105] batch_size:64
BatchInfo => Count of images in one batch:64
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([ True, False]) -> array(['R'], dtype='<U1')
One image Shape:  (224, 224, 3)
Label:  array([False,  True]) -> array(['O'], dtype='<U1')
I1130 12:01:06.737728 139791806076736 main.py:123] input_shape:(224, 224, 3)
I1130 12:01:06.737941 139791806076736 main.py:125] number_of_classes:2
I1130 12:01:06.738010 139791806076736 utils.py:72] steps_per_epoch: 352
I1130 12:01:06.738060 139791806076736 utils.py:73] total_num_of_samples: 22564
I1130 12:01:06.738119 139791806076736 utils.py:74] batch_size: 64
I1130 12:01:06.738170 139791806076736 utils.py:72] steps_per_epoch: 39
I1130 12:01:06.738214 139791806076736 utils.py:73] total_num_of_samples: 2513
I1130 12:01:06.738259 139791806076736 utils.py:74] batch_size: 64
I1130 12:01:06.813139 139791806076736 simple_trainer.py:27] model.compile()
I1130 12:01:06.813347 139791806076736 simple_trainer.py:28] loss:categorical_crossentropy
I1130 12:01:06.813406 139791806076736 simple_trainer.py:29] optimizer:adam
I1130 12:01:07.174251 139791806076736 simple_trainer.py:40] model.fit()
I1130 12:01:07.174463 139791806076736 simple_trainer.py:41] run_id: cnn_model
I1130 12:01:07.174522 139791806076736 simple_trainer.py:42] epochs:10
I1130 12:01:07.174590 139791806076736 simple_trainer.py:43] steps_per_epoch:352
I1130 12:01:07.174636 139791806076736 simple_trainer.py:44] validation_steps:39
W1130 12:01:10.471543 139791806076736 callbacks.py:248] Method (on_train_batch_end) is slow compared to the batch update (0.210410). Check your callbacks.
I1130 13:27:11.655033 139791806076736 simple_trainer.py:57] Model cnn_model saved to model_path: /labs/models/experiment_7/model_cnn_model.h5
I1130 13:27:11.657407 139791806076736 simple_trainer.py:61] model.evaluate()
I1130 13:27:11.657495 139791806076736 simple_trainer.py:62] run_id: cnn_model
I1130 13:27:11.657732 139791806076736 simple_trainer.py:63] test_data: <PrefetchDataset shapes: ((None, 224, 224, 3), (None, 2)), types: (tf.float32, tf.bool)>
I1130 13:27:11.657790 139791806076736 simple_trainer.py:64] steps: 2513
I1130 13:27:12.695407 139791806076736 simple_trainer.py:67] model was loaded from/labs/models/experiment_7/model_cnn_model.h5
I1130 13:27:12.695699 139791806076736 layer_utils.py:165] Model: "sequential"
I1130 13:27:12.695764 139791806076736 layer_utils.py:166] _________________________________________________________________
I1130 13:27:12.695822 139791806076736 layer_utils.py:163] Layer (type)                 Output Shape              Param #   
I1130 13:27:12.695869 139791806076736 layer_utils.py:168] =================================================================
I1130 13:27:12.696124 139791806076736 layer_utils.py:163] conv2d (Conv2D)              (None, 224, 224, 16)      448       
I1130 13:27:12.696187 139791806076736 layer_utils.py:232] _________________________________________________________________
I1130 13:27:12.696271 139791806076736 layer_utils.py:163] max_pooling2d (MaxPooling2D) (None, 74, 74, 16)        0         
I1130 13:27:12.696319 139791806076736 layer_utils.py:232] _________________________________________________________________
I1130 13:27:12.696434 139791806076736 layer_utils.py:163] conv2d_1 (Conv2D)            (None, 74, 74, 32)        4640      
I1130 13:27:12.696483 139791806076736 layer_utils.py:232] _________________________________________________________________
I1130 13:27:12.696565 139791806076736 layer_utils.py:163] max_pooling2d_1 (MaxPooling2 (None, 24, 24, 32)        0         
I1130 13:27:12.696612 139791806076736 layer_utils.py:232] _________________________________________________________________
I1130 13:27:12.696749 139791806076736 layer_utils.py:163] conv2d_2 (Conv2D)            (None, 24, 24, 64)        18496     
I1130 13:27:12.696799 139791806076736 layer_utils.py:232] _________________________________________________________________
I1130 13:27:12.696872 139791806076736 layer_utils.py:163] max_pooling2d_2 (MaxPooling2 (None, 8, 8, 64)          0         
I1130 13:27:12.696918 139791806076736 layer_utils.py:232] _________________________________________________________________
I1130 13:27:12.696994 139791806076736 layer_utils.py:163] flatten (Flatten)            (None, 4096)              0         
I1130 13:27:12.697041 139791806076736 layer_utils.py:232] _________________________________________________________________
I1130 13:27:12.697152 139791806076736 layer_utils.py:163] dense (Dense)                (None, 512)               2097664   
I1130 13:27:12.697201 139791806076736 layer_utils.py:232] _________________________________________________________________
I1130 13:27:12.697306 139791806076736 layer_utils.py:163] dense_1 (Dense)              (None, 2)                 1026      
I1130 13:27:12.697354 139791806076736 layer_utils.py:230] =================================================================
I1130 13:27:12.697866 139791806076736 layer_utils.py:242] Total params: 2,122,274
I1130 13:27:12.697947 139791806076736 layer_utils.py:243] Trainable params: 2,122,274
I1130 13:27:12.697994 139791806076736 layer_utils.py:244] Non-trainable params: 0
I1130 13:27:12.698039 139791806076736 layer_utils.py:245] _________________________________________________________________
I1130 13:29:30.058321 139791806076736 logger.py:42] Removing cache_file_dir: /labs/data/processed/experiment_7
I1130 13:29:30.844870 139791806076736 logger.py:44] LOGGING END. Data was saved to logs_dir: /labs/logs/experiment_7, models_dir: /labs/models/experiment_7
